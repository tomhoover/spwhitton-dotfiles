#!/bin/sh
. $HOME/.shenv

# Create my cabal config file, which needs to be different for root
# and must contain absolute path to home directory (AFAICT).

if [ "$USER" = "root" ]; then
    sandbox="False"
else
    sandbox="True"
fi

mkdir -p $HOME/.cabal
cat > $HOME/.cabal/config << EOF
-- Cabal library version: 1.22.0.0
-- cabal-install version: 1.22.0.0

-- DO NOT EDIT.  This file was automatically generated by
-- ~/bin/makecabalconf AND WILL BE OVERWRITTEN on the next invocation.

require-sandbox: $sandbox
remote-repo: hackage.haskell.org:http://hackage.haskell.org/packages/archive
remote-repo-cache: $HOME/.cabal/packages
world-file: $HOME/.cabal/world
extra-prog-path: $HOME/.cabal/bin
build-summary: $HOME/.cabal/logs/build.log
remote-build-reporting: anonymous
jobs: \$ncpus

-- The following line is suggested by
-- <http://www.vex.net/~trebla/haskell/cabal-cabal.xhtml>.
-- Unfortunately a lot of Debian ghc-* and libghc-* packages don't
-- have profiling information and you have to install the -prof
-- version.  This is too much to do for now.  Maybe I'll kick myself
-- later when I want profiling.

-- library-profiling: True

documentation: True
haddock
  hyperlink-source: True
EOF

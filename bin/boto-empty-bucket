#!/usr/bin/env python

"""boto-empty-bucket -- delete all versions from an s3 bucket"""

import boto
import sys

def main():
    """Main procedure"""

    bucket = sys.argv[1]

    connection = boto.connect_s3()
    bucket = connection.get_bucket(bucket)

    for version in bucket.list_versions():
        print "deleting", version.name, "version", version.version_id
        bucket.delete_key(version.name, version_id=version.version_id)

if __name__ == "__main__":
    main()

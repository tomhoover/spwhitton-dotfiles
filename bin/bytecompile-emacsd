#!/bin/sh

# Byte-compile lisp files in ~/.emacs.d

# `batch-byte-compile' doesn't recurse, but the layout of my
# ~/.emacs.d means it doesn't need to -- see comments near top of
# ~/.emacs.d/init.el

# Don't use -q or -Q so that my load-path gets set correctly by
# ~/.emacs.d/init.el, with Debian packages taking precedence

set -e

if which emacs >/dev/null 2>&1; then
    if which chronic >/dev/null 2>&1; then
        chronic emacs --batch --eval "(batch-byte-compile t)" \
                $HOME/.emacs.d/*.el $HOME/.emacs.d/*/*.el
    else
        echo >&2 "W: not byte-compiling ~/.emacs.d: chronic unavailable"
    fi
else
    echo >&2 "W: not byte-compiling ~/.emacs.d: Emacs unavailable"
fi
